@model CMCS.Models.MonthlyClaim
@{
    ViewData["Title"] = "Review Draft Claim";
}

<h1 class="display-6 mb-3">Review Your Claim</h1>

<!-- ===== Status messages ===== -->
@if (TempData["ok"] != null)
{
    <div class="alert alert-success">@TempData["ok"]</div>
}
@if (TempData["warn"] != null)
{
    <div class="alert alert-warning">@TempData["warn"]</div>
}

<!-- ===== Claim summary ===== -->
<div class="card shadow-sm mb-4">
    <div class="card-body">
        <dl class="row mb-0">
            <dt class="col-sm-3">Period</dt>
            <dd class="col-sm-9">@Model.PeriodLabel</dd>

            <dt class="col-sm-3">Status</dt>
            <dd class="col-sm-9">
                <span class="badge bg-secondary">@Model.Status</span>
            </dd>

            <dt class="col-sm-3">Hours</dt>
            <dd class="col-sm-9">@Model.Hours</dd>

            <dt class="col-sm-3">Rate (R/hr)</dt>
            <dd class="col-sm-9">@Model.Rate</dd>

            <dt class="col-sm-3">Amount (R)</dt>
            <dd class="col-sm-9 fw-bold">@Model.Amount</dd>

            @if (!string.IsNullOrWhiteSpace(Model.Notes))
            {
                <dt class="col-sm-3">Notes</dt>
                <dd class="col-sm-9">@Model.Notes</dd>
            }

            @if (!string.IsNullOrWhiteSpace(Model.ManagerRemark))
            {
                <dt class="col-sm-3 text-danger">Manager Remark</dt>
                <dd class="col-sm-9 text-danger">@Model.ManagerRemark</dd>
            }

            @if (Model.SubmittedAt.HasValue)
            {
                <dt class="col-sm-3">Submitted At</dt>
                <dd class="col-sm-9">@Model.SubmittedAt.Value.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>
            }

            @if (Model.ApprovedAt.HasValue)
            {
                <dt class="col-sm-3">Approved At</dt>
                <dd class="col-sm-9">@Model.ApprovedAt.Value.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>
            }

            @if (Model.RejectedAt.HasValue)
            {
                <dt class="col-sm-3">Rejected At</dt>
                <dd class="col-sm-9">@Model.RejectedAt.Value.ToLocalTime().ToString("yyyy-MM-dd HH:mm")</dd>
            }
        </dl>
    </div>
</div>

<!-- ===== Supporting documents section ===== -->
<h5>Supporting Documents</h5>
<p class="text-muted">
    Attach supporting documents before submitting your claim.
    Allowed formats: <strong>PDF</strong>, <strong>DOCX</strong>, <strong>XLSX</strong>
</p>

<a class="btn btn-outline-primary"
   asp-controller="Documents"
   asp-action="Upload"
   asp-route-claimId="@Model.Id">
    Upload Document
</a>

<hr />
<h4>Confirm Submission</h4>
<p>Please confirm that all details are correct before final submission.</p>

<form asp-action="ConfirmSubmit" method="post">
    @Html.AntiForgeryToken()
    <input type="hidden" asp-for="Id" />
    <button type="submit" class="btn btn-success">Confirm &amp; Submit</button>
    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-outline-secondary">Edit</a>
</form>

<!-- ===== Progress display (optional aesthetic) ===== -->
@if (Model.Status == CMCS.Models.ClaimStatus.Draft)
{
    <div class="mt-4 progress" style="height: 24px;">
        <div class="progress-bar bg-secondary" style="width: 25%;">
            Draft
        </div>
    </div>
}
else if (Model.Status == CMCS.Models.ClaimStatus.Pending)
{
    <div class="mt-4 progress" style="height: 24px;">
        <div class="progress-bar bg-warning text-dark" style="width: 60%;">
            Pending Manager Review
        </div>
    </div>
}
else if (Model.Status == CMCS.Models.ClaimStatus.Approved)
{
    <div class="mt-4 progress" style="height: 24px;">
        <div class="progress-bar bg-success" style="width: 100%;">
            Approved
        </div>
    </div>
}
else if (Model.Status == CMCS.Models.ClaimStatus.Rejected)
{
    <div class="mt-4 progress" style="height: 24px;">
        <div class="progress-bar bg-danger" style="width: 100%;">
            Rejected
        </div>
    </div>
}
